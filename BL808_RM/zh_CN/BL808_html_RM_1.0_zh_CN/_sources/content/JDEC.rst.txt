===============
JDEC
===============

简介
=====
JDEC可将内存中的jpg压缩图片解码成原始图片，进一步通过YUV2RGB模块转换成RGB模式进行显示。


主要特点
===========
- 支持YUV400/YUV420/YUV422格式
- 量化系数可调，范围是1~75、100
- 支持swap模式
- 支持skip模式，自动跳过jpg头
- 有多达16张jpg图片的缓冲区
- 支持灵活的中断配置模式，既可设定指定张数中断，也可以设置全部完成中断
   
功能描述
============
输出配置
----------
通过寄存器JDEC_CONTROL_1的位<REG_YUV_MODE>可以选择输出数据的YCbCr格式，包括YCbCr4:2:2平面模式，YCbCr4:2:0平面模式和YCbCr4:0:0灰度图。输出图像数据的起始地址由寄存器JDEC_YY_FRAME_ADDR和JDEC_UV_FRAME_ADDR决定。输出图像数据的分辨率由寄存器JDEC_FRAME_SIZE决定，该寄存器中位<REG_FRAME_HBLK>代表垂直方向8x8块的数量，位<REG_FRAME_WBLK>代表水平方向8x8块的数量。

量化系数
----------
通过寄存器JDEC_CONTROL_1的位<REG_Q_MODE>可以设置量化系数，当设置值不超过75时，量化系数为设置值；当设置值超过75时，量化系数为100。

swap模式
----------
使用swap模式时，会有两帧输出图像大小的空间作为缓冲区，当其中一帧空间放满后则会继续将解压后的图像数据放在另一块帧空间缓冲区里，来回交替使用。该模式可以和显示模块连动提高效率。

skip模式
----------
当将寄存器JDEC_HEADER_SKIP中位<REG_HDER_SKIP>设置为1时，则skip模式被启用，此时JDEC模块会以寄存器JDEC_FRAM_PUSH寄存器中位<REG_JP_ADDR>设定的jpg图片起始地址加上寄存器JDEC_HEADER_SKIP中位<REG_HDER_SKIP_BYTE>设定的偏移字节数量作为最终解压jpg的实际起始地址。这种操作方式可以用在跳过jpg头部信息的场景中。

缓冲区
-------
JDEC输入缓冲区可以存放多达16张jpg的相关信息，每次向JDEC_FRAM_PUSH寄存器的位<REG_JP_PUSH>写1都会使得缓冲区可用空间递减，JDEC每次解压完一张JPG后该缓冲区的可用空间会递增，可通过读取JDEC_FRAM_STS寄存器中的位<JP_FRAME_CNT>获取当前缓冲区中待解压的jpg图片数量。JDEC_CONTROL_3寄存器中的位<FRAME_VALID_CNT>表示当前解压完成但没有POP的图片数量。

操作流程
----------
- 失能JDEC模块，将寄存器JDEC_CONTROL_1中位REG_MJ_DEC_ENABLE清零。
- 设置输出图像数据的模式为YUV422/YUV420/YUV400等。
- 根据应用场景选择是否使能swap模式。
- 设置图像的量化系数。
- 设定输出图像Y和UV分量分别在内存中的起始地址。
- 根据数据图像数据的分辨率设置水平和垂直的8x8块数量。
- 如果需要使能skip模式，则需要设置skip的字节数量。
- 使能JDEC模块，将寄存器JDEC_CONTROL_1中位REG_MJ_DEC_ENABLE置1。
- 同步写入输入jpg图像的起始地址和加入缓冲区的命令，即将jpg图像的起始地址写入寄存器JDEC_FRAM_PUSH且该寄存器的位<REG_JP_PUSH>为1。
   
使用注意事项
===============
- JPG图片在内存中的起始地址需要8字节对齐
- JPG图片的分辨率必须是8的整数倍
- 目前仅支持标准的霍夫曼编码

寄存器描述
====================