<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14. IR &mdash; BL808 Reference Manual  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="15. SPI" href="SPI.html" />
    <link rel="prev" title="13. CAM" href="Cam.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BL808 Reference Manual
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SystemAndMemoryOverview.html">1. System and Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="ResetAndClock.html">2. Reset and Clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="GLB.html">3. GLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="GPIO.html">4. GPIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADC.html">5. ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="DAC.html">6. DAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="DMA.html">7. DMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="DMA2D.html">8. DMA2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lz4d.html">9. LZ4D</a></li>
<li class="toctree-l1"><a class="reference internal" href="DBI.html">10. DBI</a></li>
<li class="toctree-l1"><a class="reference internal" href="DPI.html">11. DPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="DSI.html">12. DSI</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cam.html">13. CAM</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. IR</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">14.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#features">14.2. Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functional-description">14.3. Functional Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fixed-protocol-based-receiving">14.3.1. Fixed Protocol Based Receiving</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse-width-receiving">14.3.2. Pulse width receiving</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normal-sending-mode">14.3.3. Normal sending mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pulse-width-sending">14.3.4. Pulse width sending</a></li>
<li class="toctree-l3"><a class="reference internal" href="#carrier-modulation">14.3.5. Carrier modulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#free-mode">14.3.6. Free mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dma-mode">14.3.7. DMA mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ir-interrupt">14.3.8. IR Interrupt</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SPI.html">15. SPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="UART.html">16. UART</a></li>
<li class="toctree-l1"><a class="reference internal" href="I2C.html">17. I2C</a></li>
<li class="toctree-l1"><a class="reference internal" href="PWM.html">18. PWM</a></li>
<li class="toctree-l1"><a class="reference internal" href="TIMER.html">19. TIMER</a></li>
<li class="toctree-l1"><a class="reference internal" href="I2s.html">20. I2S</a></li>
<li class="toctree-l1"><a class="reference internal" href="PDM.html">21. PDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="AUDIO.html">22. AUDIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSRAM.html">23. PSRAM Contorller</a></li>
<li class="toctree-l1"><a class="reference internal" href="Emac.html">24. Emac</a></li>
<li class="toctree-l1"><a class="reference internal" href="USB.html">25. USB</a></li>
<li class="toctree-l1"><a class="reference internal" href="ISO11898.html">26. ISO11898</a></li>
<li class="toctree-l1"><a class="reference internal" href="MJPEG.html">27. MJPEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="JDEC.html">28. JDEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="VENC.html">29. VENC</a></li>
<li class="toctree-l1"><a class="reference internal" href="NPUtoolchain.html">30. NPU toolchain</a></li>
<li class="toctree-l1"><a class="reference internal" href="NPU.html">31. NPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="IPC.html">32. IPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="LowPower.html">33. LowPower</a></li>
<li class="toctree-l1"><a class="reference internal" href="SEC_ENG.html">34. SEC ENG</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">35. Revision history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BL808 Reference Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">14. </span>IR</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ir">
<h1><span class="section-number">14. </span>IR<a class="headerlink" href="#ir" title="Permalink to this headline"></a></h1>
<section id="overview">
<h2><span class="section-number">14.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>Infrared Remote Control (IR) is a wireless and non-contact control technique that features strong anti-interference, reliable information transmission, low power consumption, and low cost. The IR radiating circuit uses the IR LED to emit the modulated infrared waves. The receiving circuit consists of infrared receiving diodes, triodes or silicon photocells, which convert the infrared light emitted by the infrared transmitter into corresponding electrical signals, and then send them to the post amplifier.</p>
</section>
<section id="features">
<h2><span class="section-number">14.2. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Receives data through the fixed NEC and RC5 protocols</p></li>
<li><p>Receives data in any format by pulse width counting</p></li>
<li><p>With powerful infrared waveform editing capability: It can emit waveforms conforming to various protocols</p></li>
<li><p>Up to 15-gear power settings to adapt to different power consumption requirements</p></li>
<li><p>Receives up to 64-bit data</p></li>
<li><p>Sends up to 128-bit data in the non-free mode and continuously sends the data of any length in the free mode</p></li>
<li><p>4*4 byte TX FIFO, 64*2 byte RX FIFO</p></li>
<li><p>Adjustable width of the TX FIFO in the free mode (8/16/24/32-bit)</p></li>
<li><p>Programmable carrier frequency and duty ratio</p></li>
<li><p>Maximum operating frequency of 32 MHz</p></li>
<li><p>Supports the DMA sending mode</p></li>
<li><p>End of sending and receiving interrupts</p></li>
</ul>
</section>
<section id="functional-description">
<h2><span class="section-number">14.3. </span>Functional Description<a class="headerlink" href="#functional-description" title="Permalink to this headline"></a></h2>
<section id="fixed-protocol-based-receiving">
<h3><span class="section-number">14.3.1. </span>Fixed Protocol Based Receiving<a class="headerlink" href="#fixed-protocol-based-receiving" title="Permalink to this headline"></a></h3>
<p>IR receiving supports the fixed NEC and RC5 protocols.</p>
<ul class="simple">
<li><p>NEC Protocol</p></li>
</ul>
<p>Logical ‘1’ and logical ‘0’ waveforms of the NEC protocol are shown as follows:</p>
<figure class="align-center" id="id1">
<img alt="../_images/IRNecLogical.svg" src="../_images/IRNecLogical.svg" /><figcaption>
<p><span class="caption-number">Fig. 14.1 </span><span class="caption-text">NEC Logic Waveform</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Logical ‘1’ is 2.25 ms and the pulse time is 560 us. Logical ‘0’ is 1.12 ms and the pulse time is 560 us.
The format of the NEC protocol is shown as follows:</p>
<figure class="align-center" id="id2">
<img alt="../_images/IRNec.svg" src="../_images/IRNec.svg" /><figcaption>
<p><span class="caption-number">Fig. 14.2 </span><span class="caption-text">NEC Protocol Waveform</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The head pulse is a 9 ms high-level pulse and a 4.5 ms low-level pulse, followed by an 8-bit address code and its radix-minus-one complement (diminished radix complement), then an 8-bit command code and its radix complement, and the tail pulse is a 560 us high-level pulse and a 560 us low-level pulse.</p>
<ul class="simple">
<li><p>RC5 Protocol</p></li>
</ul>
<p>Logical ‘1’ and logical ‘0’ waveforms of the RC5 protocol are shown as follows:</p>
<figure class="align-center" id="id3">
<img alt="../_images/IRRc5Logical.svg" src="../_images/IRRc5Logical.svg" /><figcaption>
<p><span class="caption-number">Fig. 14.3 </span><span class="caption-text">RC5 Logic Waveform</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The logical ‘1’ is 1.778 ms, first the 889 us low level and then the 889 us high level. Logical ‘0’ is opposite to the logical 1 waveform.
The format of the RC5 protocol is shown as follows:</p>
<figure class="align-center" id="id4">
<img alt="../_images/IRRc5.svg" src="../_images/IRRc5.svg" /><figcaption>
<p><span class="caption-number">Fig. 14.4 </span><span class="caption-text">RC5 Protocol Waveform</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The first two bits are the Start bits, both logical ‘1’. The third bit is the toggle bit, which toggles each time a key is released and pressed again. The next 5 bits are address bits and the next 6 bits are command bits.</p>
<p>It is worth noting that to improve the receiving sensitivity, the common infrared integrated receiver outputs a low level after receiving a high level, so you need to enable the receiving toggle function when using the IR receiving function.</p>
</section>
<section id="pulse-width-receiving">
<h3><span class="section-number">14.3.2. </span>Pulse width receiving<a class="headerlink" href="#pulse-width-receiving" title="Permalink to this headline"></a></h3>
<p>For data in any format other than the NEC and RC5 protocols, IR will count the duration of each high or low level in turn by its clock, and then store the data into the RX FIFO with a depth of 64 and a width of 2 bytes.</p>
</section>
<section id="normal-sending-mode">
<h3><span class="section-number">14.3.3. </span>Normal sending mode<a class="headerlink" href="#normal-sending-mode" title="Permalink to this headline"></a></h3>
<p>You can configure the head pulse, tail pulse, logical ‘0’ pulse, and logical ‘1’ pulse depending on protocols. During setting, you need to calculate the common pulse width unit—the greatest common divisor—of various pulses with different widths in the used protocol, fill it in the low 12 bits in the register IRTX_PULSE_WIDTH, and then fill the corresponding multiple of each pulse in the register IRTX_PW.</p>
<p>Then, you can fill the logic value to be sent into the TX FIFO with a depth of 4 and a width of 4 bytes.</p>
</section>
<section id="pulse-width-sending">
<h3><span class="section-number">14.3.4. </span>Pulse width sending<a class="headerlink" href="#pulse-width-sending" title="Permalink to this headline"></a></h3>
<p>IR provides a way of sending pulse width for the protocols that are unsuitable for the normal sending mode. You need to calculate the common pulse width unit—the greatest common divisor—of various pulses with different widths in the used protocol, and fill it in the low 12 bits in the register IRTX_PULSE_WIDTH. Then, for the multiples (8-bit per multiple) corresponding to each level width from the first high level to the last level, every four multiples are combined into a 32-bit number for padding in the TX FIFO.</p>
</section>
<section id="carrier-modulation">
<h3><span class="section-number">14.3.5. </span>Carrier modulation<a class="headerlink" href="#carrier-modulation" title="Permalink to this headline"></a></h3>
<p>Setting the high 16 bits of the register IRTX_PULSE_WIDTH can generate carriers with different frequencies and duty ratios. The &lt;TXMPH1W&gt; bit in the register is set to the width of carrier phase 1, while the &lt;TXMPH0W&gt; bit is set to the width of carrier phase 0.</p>
</section>
<section id="free-mode">
<h3><span class="section-number">14.3.6. </span>Free mode<a class="headerlink" href="#free-mode" title="Permalink to this headline"></a></h3>
<p>In the free mode, there is no limit to the total length of data to be sent. When there is data in TX FIFO, it will be sent, so it can be used with DMA. The width of TX FIFO in free mode can be configured to 8/16/24/32-bit.</p>
</section>
<section id="dma-mode">
<h3><span class="section-number">14.3.7. </span>DMA mode<a class="headerlink" href="#dma-mode" title="Permalink to this headline"></a></h3>
<p>IR TX supports the DMA mode, which requires to enable the free mode and set the threshold of TX FIFO by configuring &lt;TFITH&gt; in the register IRTX_FIFO_CONFIG_1.</p>
<p>When this mode is enabled, if &lt;TFICNT&gt; in the IRTX_FIFO_CONFIG_1 is greater than &lt;TFITH&gt;, the DMA TX request will be triggered. After DMA is configured, when receiving this request, DMA will transfer data from memory to TX FIFO as configured.</p>
</section>
<section id="ir-interrupt">
<h3><span class="section-number">14.3.8. </span>IR Interrupt<a class="headerlink" href="#ir-interrupt" title="Permalink to this headline"></a></h3>
<p>There are separate end of sending and receiving interrupts for IR, and when a sending action ends, a TX interrupt will be generated. When a piece of data is received, it will wait for the level duration to reach the preset end threshold before generating a receiving interrupt.</p>
<p>The register IRTX_INT_STS can query the TX interrupt status and clear the interrupt, and the register IRRX_INT_STS can query the receiving interrupt status and clear the interrupt.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Cam.html" class="btn btn-neutral float-left" title="13. CAM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SPI.html" class="btn btn-neutral float-right" title="15. SPI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>