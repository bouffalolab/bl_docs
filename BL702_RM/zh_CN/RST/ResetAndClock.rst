============
复位和时钟
============
简介
========
芯片内部包含的复位源：硬件重置，看门狗重置，软件复位。
芯片内包含多个时钟源：XTAL，DLL，RC。搭配分频等配置送至各模块。

复位源
===========

复位源包含

- 硬件重置:通过管脚进行重置

  - 管脚电源重置（PU_CHIP = 0-> 1）：类似电源上电重置
  - 电源上电重置：芯片从断电中复电，HBN逻辑将芯片系统进行重置

- 看门狗重置

  - 当看门狗报警触发重置信号时，重置管理单元将在必要准备后，重置芯片系统，看门狗内部逻辑会记录看门狗重置的状态

- 软件复位:通过软件设置寄存器进行全局或局部复位

  - 软件初始重置（reg_ctrl_pwron_rst）：通过软件将该位置1，进行芯片系统重置
  - 软件CPU复位（reg_ctrl_cpu_reset）：通过软件将该位置1，进行CPU部分系统复位
  - 软件系统复位（reg_ctrl_sys_reset）：通过软件将该位置1，保留必要的逻辑处理如电源管理单元，进行芯片部分系统复位
  - 软件模块复位：根据特定模块的需求，设置软件复位

.. figure:: ../../picture/ResetTop.svg
   :align: center

   复位源

时钟源
===========

时钟源包含：

- XTAL   ：外部晶振时钟，主要支持频率32MHz
- XTAL32K：外部晶振时钟，频率32KHz
- RC32M  ：RC振荡器时钟，频率32MHz，提供校准
- DLL    ：锁相回路时钟，内部系统高速时钟，最高频率支持144MHz

时钟控制单元将来自振荡器的时钟分配给内核和外围设备。
可通过选择系统时钟源，动态分频器，时钟配置，睡眠使用32KHz时钟，以达到低功耗时钟管理。

外围设备时钟包括: Flash、USB2.0、Ethernet、UART、I2C、I2S、SPI、PWM、IR-remote、QDEC、KeyScan、ADC、DAC。

.. figure:: ../../picture/ClockTree.svg
   :align: center

   时钟架构
