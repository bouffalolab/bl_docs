===========
GLB
===========

简介
=====
GLB(Global Register)是芯片通用全局设定模块，主要包含了时钟管理、复位管理、总线管理、内存管理以及GPIO管理等功能。

功能描述
===========
时钟管理
-------------
时钟管理功能主要用于设定处理器、总线、各个外设的时钟，通过该模块可以设定上述模块工作的时钟源，时钟分频等，同时也可以实现对上述模块时钟的门控，以达到系统低功耗的目的。
详细设定可以参考复位和时钟章节。

复位管理
-------------
提供各个外设模块的单独复位功能以及芯片复位功能。芯片复位包括：

- CPU复位：仅仅复位CPU模块，程序会重新运行，外设不会被复位

- 系统复位：各个外设和CPU会被复位，但是AON域的相关寄存器不会被复位

- 上电复位：整个系统包括AON域的相关寄存器都会被复位

应用程序可以根据需要，选择使用对应的复位方式。

.. table:: 软件复位功能表 
    :widths: 15,25,15,15,15,15
    :width: 100
    :align: center

    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | BL702  | RST_PIN/HBN/WDT/POWER ON      | SW.Reset       | CPU/PDS/SYS            | PDS/CPU            | PDS         |
    +========+===============================+================+========================+====================+=============+
    | CPU    | ✔                             |                |                        | ✔                  |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | bus    | ✔                             |                | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | glb    | ✔                             | swrst_s1[0]    |                        |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | gpip   | ✔                             | swrst_s1[2]    | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | l1c    | ✔                             | swrst_s1[9]    | ✔                      | ✔                  |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | dma    | ✔                             | swrst_s1[12]   | ✔                      |                    |             | 
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | emac   | ✔                             | swrst_s1[13]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | usb    | ✔                             | swrst_s1a[12]  | ✔                      |                    | ✔           |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | pds    |                               | swrst_s1[14]   |                        |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | uart0  | ✔                             | swrst_s1a[0]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | uart1  | ✔                             | swrst_s1a[1]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | spi    | ✔                             | swrst_s1a[2]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | I2C    | ✔                             | swrst_s1a[3]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | pwm    | ✔                             | swrst_s1a[4]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | timer  | ✔                             | swrst_s1a[5]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | irr    | ✔                             | swrst_s1a[6]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | qdec0  | ✔                             | swrst_s1a[8]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | qdec1  | ✔                             | swrst_s1a[8]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | qdec2  | ✔                             | swrst_s1a[8]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | kys    | ✔                             | swrst_s1a[9]   | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+
    | i2s    | ✔                             | swrst_s1a[10]  | ✔                      |                    |             |
    +--------+-------------------------------+----------------+------------------------+--------------------+-------------+

总线管理
-------------
提供总线的仲裁设定以及总线出错设定，可以设定在总线出错时是否产生中断，并提供出错总线地址信息，方便用户调试程序。

内存管理
-------------
提供各个内存模块在芯片系统进入低功耗模式时的功耗管理，包含两种设定模式：

- retention模式：在该模式下，内存上的数据可以保存，但是在退出低功耗模式之前，无法读写。
- sleep模式：在该模式下，内存的数据会丢失，仅用于降低系统功耗。

GPIO概述
-------------
GPIO管理功能提供GPIO控制寄存器，实现软件对 GPIO 属性的配置，使用户能够方便地操作 GPIO。每个GPIO可以配置为software GPIO或其它复用功能。在每个功能下，提供设置上拉，下拉，浮空三种端口状态(配置为模拟功能时必须设置为浮空)，此外GPIO还提供中断功能，可以配置为上升沿触发，下降沿触发、高电平触发或者低电平触发。每个GPIO可以拥有两组中断配置，两组中断配置可以同时起效，例如GPIO0的INT0配置为上升沿触发、INT1配置为下降沿触发，则最终效果为GPIO双边沿都会触发中断。

GPIO主要特点
-------------

- 可以配置为software GPIO功能
- 可以配置为其它复用功能，搭配外设功能使用，在配置为模拟功能时，必须设置为浮空
- 可以设置输入或输出模式，并设定为上拉，下拉或者浮空
- 可以设置驱动能力，以提供更大的输出电流
- 可以设置施密特触发器功能，提供简单硬件防抖功能

GPIO功能描述
-------------
每个GPIO可以通过软件配置为：

- 复用功能：I2S、SPI、I2C、UART、PWM、USB、SWGPIO......多达24种function
- InputEnable/OutputEnable：输入、输出、高阻（ie=0,oe=0）
- PullUp/PullDown：上拉、下拉、浮空（pu=0,pd=0）
- drive strength：0、1、2、3四个档位，数值越大，驱动能力越强
- smt触发器：smt enable、smt disable，用以防止触发阈值附近的抖动

当GPIO复用功能配置为SWGPIO input时还可以为其配置中断触发方式，且每个GPIO可以有两个中断模式，两个中断模式均可以单独/同时起效：

- 中断模式1：上升沿触发、下降沿触发、高电平触发、低电平触发
- 中断模式2：上升沿触发、下降沿触发、高电平触发、低电平触发

GPIO模块基本框图如下图所示。

.. figure:: ../../picture/GPIOBasicStruct.svg
   :align: center

   GPIO基本框图

GPIO功能设定
-------------

GPIO的功能通过GPIO_CFGCTL寄存器组设定，主要设定项包括：

- func_sel：选择GPIO功能
- pu：选择是否上拉
- pd：选择是否下拉
- drv：设定驱动能力
- smt：选择是否使能施密特触发器
- ie：设定输入使能
- oe：设定输出使能

GPIO可以设定的功能包括：

- Flash/QSPI：设定GPIO为QSPI功能，可以连接Flash，作为程序存储/运行介质
- SPI：设定GPIO为SPI功能
- I2C：设定GPIO为I2C功能
- UART：设定GPIO为UART功能
- PWM：设定GPIO为PWM功能
- ANA：设定GPIO为Analog功能
- SWGPIO：设定GPIO为通用IO功能
- JTAG：设定GPIO为JTAG功能
- 其它复用功能


为了最大限度的满足客户需求，每个GPIO基本上都可以选择上述可选功能，当选择某个可选功能时，GPIO与对应的功能信号如下表所示：


.. table:: GPIO功能表1 TB_SIZE_TINY
    :widths: 10,10,15,15,15,10,15,10
    :width: 100
    :align: center

    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO   |  CLK_OUT   |   Flash_PSRAM   |         I2S         |           SPI0          |    I2C     |  UART     |    PWM     |
    +========+============+=================+=====================+=========================+============+===========+============+
    | GPIO0  | clk_out[0] |                 | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG0 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO1  | clk_out[1] |                 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG1 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO2  | clk_out[0] |                 | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG2 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO3  | clk_out[1] |                 | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG3 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO4  | clk_out[0] |                 | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG4 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO5  | clk_out[1] |                 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG5 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO6  | clk_out[0] |                 | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG6 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO7  | clk_out[1] |                 | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG7 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO8  | clk_out[0] |                 | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG0 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO9  | clk_out[1] |                 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG1 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO10 | clk_out[0] |                 | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG2 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO11 | clk_out[1] |                 | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG3 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO12 | clk_out[0] |                 | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG4 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO13 | clk_out[1] |                 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG5 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO14 | clk_out[0] |                 | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG6 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO15 | clk_out[1] |                 | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG7 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO16 | clk_out[0] |                 | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG0 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO17 | clk_out[1] | SF_IO_0/SF2_CS2 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG1 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO18 | clk_out[0] | SF_IO_1         | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG2 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO19 | clk_out[1] | SF_CS           | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG3 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO20 | clk_out[0] | SF_IO_3         | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG4 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO21 | clk_out[1] | SF_CLK          | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG5 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO22 | clk_out[0] | SF_IO_2         | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG6 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO23 | clk_out[1] | SF2_IO_2        | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG7 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO24 | clk_out[0] | SF2_IO_1        | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG0 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO25 | clk_out[1] | SF2_CS          | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG1 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO26 | clk_out[0] | SF2_IO_3        | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG2 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO27 | clk_out[1] | SF2_CLK         | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG3 |   PWM[2]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO28 | clk_out[0] | SF2_IO_0        | I2S0_BCLK           |  SPI_0_MOSI             |  I2C0_SCL  | UART_SIG4 |   PWM[3]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO29 | clk_out[1] |                 | I2S0_FS             |  SPI_0_MISO             |  I2C0_SDA  | UART_SIG5 |   PWM[4]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO30 | clk_out[0] |                 | I2S0_DIO/I2S0_DO    |  SPI_0_SS               |  I2C0_SCL  | UART_SIG6 |   PWM[0]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+
    | GPIO31 | clk_out[1] |                 | I2S0_RCLK_O/I2S0_DI |  SPI_0_SCLK             |  I2C0_SDA  | UART_SIG7 |   PWM[1]   |
    +--------+------------+-----------------+---------------------+-------------------------+------------+-----------+------------+



..    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO   |    CAM     |              Analog                |    SWGPIO    |      JTAG       |  Ether_Mac  |    QDEC   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO0  | PIX_CLK    |                                    | REG_GPIO[0]  | E21_TMS/E21_TCK | MII_REF_CLK | qdec0_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO1  | FRAME_VLD  |                                    | REG_GPIO[1]  | E21_TDI/E21_TDO | MII_TXD[0]  | qdec0_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO2  | LINE_VLD   |                                    | REG_GPIO[2]  | E21_TCK/E21_TMS | MII_TXD[1]  | qdec0_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO3  | PIX_DAT0   |                                    | REG_GPIO[3]  | E21_TDO/E21_TDI |             | qdec1_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO4  | PIX_DAT1   |                                    | REG_GPIO[4]  | E21_TMS/E21_TCK |             | qdec1_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO5  | PIX_DAT2   |                                    | REG_GPIO[5]  | E21_TDI/E21_TDO |             | qdec1_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO6  | PIX_DAT3   |                                    | REG_GPIO[6]  | E21_TCK/E21_TMS |             | qdec2_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO7  |            | USB_DP/gpip_ch[6]/gpdac_vref_ext   | REG_GPIO[7]  | E21_TDO/E21_TDI | MII_RXD[0]  | qdec2_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO8  |            | USB_DM/gpip_ch[0]                  | REG_GPIO[8]  | E21_TMS/E21_TCK | MII_RXD[1]  | qdec2_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO9  |            | pmip_dc_tp/clkpll_dc_tp/gpip_ch[7] | REG_GPIO[9]  | E21_TDI/E21_TDO |             | qdec0_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO10 |            | MICBIAS                            | REG_GPIO[10] | E21_TCK/E21_TMS |             | qdec0_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO11 |            | gpip_ch[3]                         | REG_GPIO[11] | E21_TDO/E21_TDI |             | qdec0_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO12 | PIX_DAT4   | gpip_ch[4]                         | REG_GPIO[12] | E21_TMS/E21_TCK |             | qdec1_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO13 |            |                                    | REG_GPIO[13] | E21_TDI/E21_TDO |             | qdec1_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO14 |            | gpip_ch[5]/atest_out_0             | REG_GPIO[14] | E21_TCK/E21_TMS |             | qdec1_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO15 |            | gpip_ch[1]/atest_out_1             | REG_GPIO[15] | E21_TDO/E21_TDI |             | qdec2_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO16 |            |                                    | REG_GPIO[16] | E21_TMS/E21_TCK |             | qdec2_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO17 | PIX_DAT4   | gpip_ch[2]/psw_irrcv               | REG_GPIO[17] | E21_TDI/E21_TDO |             | qdec2_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO18 | PIX_DAT5   | gpip_ch[8]                         | REG_GPIO[18] | E21_TCK/E21_TMS | RMII_MDC    | qdec0_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO19 | PIX_DAT6   | gpip_ch[9]                         | REG_GPIO[19] | E21_TDO/E21_TDI | RMII_MDIO   | qdec0_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO20 | PIX_DAT7   | gpip_ch[10]                        | REG_GPIO[20] | E21_TMS/E21_TCK | RMII_RXERR  | qdec0_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO21 |            | gpip_ch[11]                        | REG_GPIO[21] | E21_TDI/E21_TDO | RMII_TX_EN  | qdec1_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO22 |            | leddrv[0]                          | REG_GPIO[22] | E21_TCK/E21_TMS | RMII_RX_DV  | qdec1_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO23 | PIX_DAT4   | leddrv[1]/flash_pull_out[0]        | REG_GPIO[23] | E21_TDO/E21_TDI |             | qdec1_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO24 | PIX_DAT5   | flash_pull_out[1]                  | REG_GPIO[24] | E21_TMS/E21_TCK | RMII_MDC    | qdec2_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO25 | PIX_DAT6   | flash_pull_out[2]                  | REG_GPIO[25] | E21_TDI/E21_TDO | RMII_MDIO   | qdec2_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO26 | PIX_DAT7   | flash_pull_out[3]                  | REG_GPIO[26] | E21_TCK/E21_TMS | RMII_RXERR  | qdec2_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO27 |            | flash_pull_out[4]                  | REG_GPIO[27] | E21_TDO/E21_TDI | RMII_TX_EN  | qdec0_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO28 | PIX_DAT4   | flash_pull_out[5]                  | REG_GPIO[28] | E21_TMS/E21_TCK | RMII_RX_DV  | qdec0_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO29 | PIX_DAT5   |                                    | REG_GPIO[29] | E21_TDI/E21_TDO |             | qdec0_led |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO30 | PIX_DAT6   |                                    | REG_GPIO[30] | E21_TCK/E21_TMS |             | qdec1_a   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO31 | PIX_DAT7   |                                    | REG_GPIO[31] | E21_TDO/E21_TDI |             | qdec1_b   |
    +--------+------------+------------------------------------+--------------+-----------------+-------------+-----------+

.. table:: GPIO功能表2
    :widths: 10,30,15,20,15,10
    :width: 100
    :align: center

    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO   |              Analog                |    SWGPIO    |      JTAG       |  Ether_Mac  |    QDEC   |
    +========+====================================+==============+=================+=============+===========+
    | GPIO0  |                                    | REG_GPIO[0]  | E21_TMS/E21_TCK | MII_REF_CLK | qdec0_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO1  |                                    | REG_GPIO[1]  | E21_TDI/E21_TDO | MII_TXD[0]  | qdec0_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO2  |                                    | REG_GPIO[2]  | E21_TCK/E21_TMS | MII_TXD[1]  | qdec0_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO3  |                                    | REG_GPIO[3]  | E21_TDO/E21_TDI |             | qdec1_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO4  |                                    | REG_GPIO[4]  | E21_TMS/E21_TCK |             | qdec1_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO5  |                                    | REG_GPIO[5]  | E21_TDI/E21_TDO |             | qdec1_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO6  |                                    | REG_GPIO[6]  | E21_TCK/E21_TMS |             | qdec2_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO7  | USB_DP/gpip_ch[6]/gpdac_vref_ext   | REG_GPIO[7]  | E21_TDO/E21_TDI | MII_RXD[0]  | qdec2_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO8  | USB_DM/gpip_ch[0]                  | REG_GPIO[8]  | E21_TMS/E21_TCK | MII_RXD[1]  | qdec2_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO9  | pmip_dc_tp/clkpll_dc_tp/gpip_ch[7] | REG_GPIO[9]  | E21_TDI/E21_TDO |             | qdec0_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO10 | MICBIAS                            | REG_GPIO[10] | E21_TCK/E21_TMS |             | qdec0_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO11 | gpip_ch[3]                         | REG_GPIO[11] | E21_TDO/E21_TDI |             | qdec0_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO12 | gpip_ch[4]                         | REG_GPIO[12] | E21_TMS/E21_TCK |             | qdec1_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO13 |                                    | REG_GPIO[13] | E21_TDI/E21_TDO |             | qdec1_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO14 | gpip_ch[5]/atest_out_0             | REG_GPIO[14] | E21_TCK/E21_TMS |             | qdec1_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO15 | gpip_ch[1]/atest_out_1             | REG_GPIO[15] | E21_TDO/E21_TDI |             | qdec2_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO16 |                                    | REG_GPIO[16] | E21_TMS/E21_TCK |             | qdec2_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO17 | gpip_ch[2]/psw_irrcv               | REG_GPIO[17] | E21_TDI/E21_TDO |             | qdec2_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO18 | gpip_ch[8]                         | REG_GPIO[18] | E21_TCK/E21_TMS | RMII_MDC    | qdec0_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO19 | gpip_ch[9]                         | REG_GPIO[19] | E21_TDO/E21_TDI | RMII_MDIO   | qdec0_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO20 | gpip_ch[10]                        | REG_GPIO[20] | E21_TMS/E21_TCK | RMII_RXERR  | qdec0_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO21 | gpip_ch[11]                        | REG_GPIO[21] | E21_TDI/E21_TDO | RMII_TX_EN  | qdec1_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO22 | leddrv[0]                          | REG_GPIO[22] | E21_TCK/E21_TMS | RMII_RX_DV  | qdec1_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO23 | leddrv[1]/flash_pull_out[0]        | REG_GPIO[23] | E21_TDO/E21_TDI |             | qdec1_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO24 | flash_pull_out[1]                  | REG_GPIO[24] | E21_TMS/E21_TCK | RMII_MDC    | qdec2_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO25 | flash_pull_out[2]                  | REG_GPIO[25] | E21_TDI/E21_TDO | RMII_MDIO   | qdec2_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO26 | flash_pull_out[3]                  | REG_GPIO[26] | E21_TCK/E21_TMS | RMII_RXERR  | qdec2_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO27 | flash_pull_out[4]                  | REG_GPIO[27] | E21_TDO/E21_TDI | RMII_TX_EN  | qdec0_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO28 | flash_pull_out[5]                  | REG_GPIO[28] | E21_TMS/E21_TCK | RMII_RX_DV  | qdec0_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO29 |                                    | REG_GPIO[29] | E21_TDI/E21_TDO |             | qdec0_led |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO30 |                                    | REG_GPIO[30] | E21_TCK/E21_TMS |             | qdec1_a   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+
    | GPIO31 |                                    | REG_GPIO[31] | E21_TDO/E21_TDI |             | qdec1_b   |
    +--------+------------------------------------+--------------+-----------------+-------------+-----------+


.. table:: GPIO功能表3 
    :widths: 40,60
    :width: 100
    :align: center

    +--------+------------------------------+
    | GPIO   |           SWGPIO             |
    +========+==============================+
    | GPIO17 | pad_irrx_i,irrxgpsl=1        |
    +--------+------------------------------+
    | GPIO18 | pad_irrx_i,irrxgpsl=2        |
    +--------+------------------------------+
    | GPIO19 | pad_irrx_i,irrxgpsl=3        |
    +--------+------------------------------+
    | GPIO20 | pad_irrx_i,irrxgpsl=4        |
    +--------+------------------------------+
    | GPIO21 | pad_irrx_i,irrxgpsl=5        |
    +--------+------------------------------+
    | GPIO22 | pad_irrx_i,irrxgpsl=6        |
    +--------+------------------------------+
    | GPIO23 | pad_irrx_i,irrxgpsl=7        |
    +--------+------------------------------+
    | GPIO24 | pad_irrx_i,irrxgpsl=8        |
    +--------+------------------------------+
    | GPIO25 | pad_irrx_i,irrxgpsl=9        |
    +--------+------------------------------+
    | GPIO26 | pad_irrx_i,irrxgpsl=10       |
    +--------+------------------------------+
    | GPIO27 | pad_irrx_i,irrxgpsl=11       |
    +--------+------------------------------+
    | GPIO28 | pad_irrx_i,irrxgpsl=12       |
    +--------+------------------------------+
    | GPIO29 | pad_irrx_i,irrxgpsl=13       |
    +--------+------------------------------+
    | GPIO30 | pad_irrx_i,irrxgpsl=14       |
    +--------+------------------------------+
    | GPIO31 | pad_irrx_i,irrxgpsl=15       |
    +--------+------------------------------+

当使用IR功能时，需要将GPIO设置为SWGPIO，并设置irrxgpsl寄存器（GPIO17-GPIO31可以作为IR引脚）

在上述表格中，当选择UART功能时，只是选择了UART的一个信号，并没有指定该引脚的具体功能（比如是UART TX还是UART RX),还需要通过UART_SIGX_SEL(X=0-7)进一步选择具体的UART信号及对应的功能。
每一个UART_SIGX_SEL可以选择的信号包括：

- 0 : UART0_RTS
- 1 : UART0_CTS
- 2 : UART0_TXD
- 3 : UART0_RXD
- 4 : UART1_RTS
- 5 : UART1_CTS
- 6 : UART1_TXD
- 7 : UART1_RXD

以GPIO0为例，当fun_sel选择UART的时候，GPIO0选择的是UART_SIG0,在默认情况下UART_SIG0_SEL的值是0，也就是UART0_RTS，即GPIO是UART0_RTS功能。如果应用程序想把GPIO作为UART1_TXD,那只要把UART_SIG0_SEL设置为6,
那么GPIO0的功能就是UART1_TXD。

GPIO输出设置
-------------

通过设定func_sel为SWGPIO，GPIO可以作为普通GPIO的输入/输出，将IE设置为0，OE设置为1，就可以将GPIO配置为输出功能，输出的数值通过GPIO_O寄存器组设定。
当GPIO_O对应Bit设置为0时，GPIO输出低电平，当GPIO_O对应Bit设置为1时，GPIO输出高电平。可以通过DRV控制位设置输出能力。

GPIO输入设置
-------------

通过设定func_sel为SWGPIO，将IE设置为1，OE设置为0，就可以将GPIO配置为输入功能，可以通过SMT控制位设置是否使能施密特触发器，通过PD，PU控制位设置上拉下拉属性。
外部输入的数值，可以通过读取GPIO_I寄存器对应的Bit获取到。

GPIO可选功能设置
----------------

通过设定func_sel为对应的外设功能，可以实现GPIO与外设的连接，实现外设的输入输出，从GPIO的基础功能框图可以看出，当选择可选功能时，需要将IE设置为1，OE设置为0，也就是断开普通GPIO的输出控制功能。
这样，对于固定输入功能的外设，外设的OE信号始终为0，从而实现输入功能；对于固定输出的外设，其OE信号始终为1，从而实现输出是被外设控制，而此时的输入信号就是输出信号，
但是不会被正在输出的外设采集；当外设既需要输入又要输出时，通过控制外设OE信号就可以实现输入输出。
即：对于除了SWGPIO以外的function，作为输出方向的功能时，IE和OE的配置值不影响功能，但是作为输入方向时，IE必须置一而OE的配置不影响功能；当作为SWGPIO时，IE和OE都需要正确配置。

GPIO中断设置
-------------

要使用GPIO的中断功能，需要先将GPIO设置为输入模式，中断触发模式通过GPIO_INT_MODE_SET寄存器组进行设定。可以设定的中断模式包括：

- 下降沿触发中断
- 上升沿触发中断
- 低电平触发中断
- 高电平触发中断

每个GPIO都可以设定为中断功能，是否使能某个GPIO中断可以通过GPIO_INT_MASK寄存器进行设定，中断产生时，在中断函数中可以通过GPIO_INT_STAT寄存器获取到产生中断的GPIO引脚号，同时可以通过GPIO_INT_CLR清除掉对应的中断信号。

.. only:: html

   .. include:: glb_register.rst

.. raw:: latex

   \input{../../zh_CN/content/glb}