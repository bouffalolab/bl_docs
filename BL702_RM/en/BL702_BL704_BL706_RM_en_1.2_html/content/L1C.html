<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. L1C &mdash; BL702/704/706 Reference Manual  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. IR" href="IR.html" />
    <link rel="prev" title="6. DMA" href="DMA.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BL702/704/706 Reference Manual
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SystemAndMemoryOverview.html">1. System and memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="ResetAndClock.html">2. Reset and clock</a></li>
<li class="toctree-l1"><a class="reference internal" href="GLB.html">3. GLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="ADC.html">4. ADC</a></li>
<li class="toctree-l1"><a class="reference internal" href="DAC.html">5. DAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="DMA.html">6. DMA</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. L1C</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#l1c-introduction">7.1. L1C introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#l1c-main-features">7.2. L1C main features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#l1c-function-description">7.3. L1C function description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mutual-conversion-between-tcm-and-cache-ram-resources">7.3.1. Mutual conversion between TCM and Cache RAM resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache">7.3.2. Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#register-description">7.4. Register description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#l1c-config">7.4.1. l1c_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hit-cnt-lsb">7.4.2. hit_cnt_lsb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hit-cnt-msb">7.4.3. hit_cnt_msb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miss-cnt">7.4.4. miss_cnt</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IR.html">8. IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="SPI.html">9. SPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="UART.html">10. UART</a></li>
<li class="toctree-l1"><a class="reference internal" href="I2C.html">11. I2C</a></li>
<li class="toctree-l1"><a class="reference internal" href="PWM.html">12. PWM</a></li>
<li class="toctree-l1"><a class="reference internal" href="TIMER.html">13. TIMER</a></li>
<li class="toctree-l1"><a class="reference internal" href="QDEC.html">14. QDEC</a></li>
<li class="toctree-l1"><a class="reference internal" href="KeyScan.html">15. KeyScan</a></li>
<li class="toctree-l1"><a class="reference internal" href="I2S.html">16. I2S</a></li>
<li class="toctree-l1"><a class="reference internal" href="EMAC.html">17. Emac</a></li>
<li class="toctree-l1"><a class="reference internal" href="USB.html">18. USB</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">19. Revision history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BL702/704/706 Reference Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">7. </span>L1C</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="l1c">
<h1><span class="section-number">7. </span>L1C<a class="headerlink" href="#l1c" title="Permalink to this headline"></a></h1>
<section id="l1c-introduction">
<h2><span class="section-number">7.1. </span>L1C introduction<a class="headerlink" href="#l1c-introduction" title="Permalink to this headline"></a></h2>
<p>L1 Cache Controller is a unit module located outside the processor, used to manage the code or data buffer on Flash/pSRAM and improve the speed of CPU access to Flash/pSRAM. The architecture is as follows:</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/L1CArch.svg"><img alt="../_images/L1CArch.svg" src="../_images/L1CArch.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.1 </span><span class="caption-text">L1c architecture</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>L1C is a high-speed unit integrated between the processor and Flash.
Because the speed of the processor is very fast, when the processor needs to wait for a long time to access the Flash,
the less time wasted, the higher the efficiency.
The L1C cache can be used as a lubricating role between the processor and the Flash to improve the efficiency of the processor.</p>
</section>
<section id="l1c-main-features">
<h2><span class="section-number">7.2. </span>L1C main features<a class="headerlink" href="#l1c-main-features" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>4-way Set-Associative mapping</p></li>
<li><p>Variable cache size</p></li>
<li><p>Connect to TCM address space, can easily configure L1C space as TCM space</p></li>
<li><p>Support cache performance statistics</p></li>
</ul>
</section>
<section id="l1c-function-description">
<h2><span class="section-number">7.3. </span>L1C function description<a class="headerlink" href="#l1c-function-description" title="Permalink to this headline"></a></h2>
<section id="mutual-conversion-between-tcm-and-cache-ram-resources">
<h3><span class="section-number">7.3.1. </span>Mutual conversion between TCM and Cache RAM resources<a class="headerlink" href="#mutual-conversion-between-tcm-and-cache-ram-resources" title="Permalink to this headline"></a></h3>
<p>In order to increase memory usage efficiency, it is supported to adjust all or part of the Cache’s 16K RAM to TCM space, so that users can adjust the memory usage and efficiency according to the actual situation.
The maximum Cache can be set to 16K, divided into 4 ways, each way is 4K, and the unit of adjustment is 1 way, which is 4K. The default size of ITCM is 16K. Set by WayDisable.
The actual space size of Cache and ITCM can be flexibly adjusted.</p>
<table class="colwidths-given docutils align-center" id="id2" style="width: 100%">
<caption><span class="caption-number">Table 7.1 </span><span class="caption-text">WayDisable settings</span><a class="headerlink" href="#id2" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>WayDisable</p></th>
<th class="head"><p>Cache</p></th>
<th class="head"><p>ITCM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>none</p></td>
<td><p>16K</p></td>
<td><p>0K</p></td>
</tr>
<tr class="row-odd"><td><p>one way</p></td>
<td><p>12K</p></td>
<td><p>4K</p></td>
</tr>
<tr class="row-even"><td><p>two way</p></td>
<td><p>8K</p></td>
<td><p>8K</p></td>
</tr>
<tr class="row-odd"><td><p>three way</p></td>
<td><p>4K</p></td>
<td><p>12K</p></td>
</tr>
<tr class="row-even"><td><p>four way</p></td>
<td><p>0K</p></td>
<td><p>16K</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cache">
<h3><span class="section-number">7.3.2. </span>Cache<a class="headerlink" href="#cache" title="Permalink to this headline"></a></h3>
<p>The unit of each line buffer is 32 bytes, and the 4-way associative mapping cache is used. The application architecture is as follows:</p>
<figure class="align-center" id="id3">
<img alt="../_images/L1cWay.svg" src="../_images/L1cWay.svg" /><figcaption>
<p><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Cache architecture</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Each set of associative mapping caches contains two parts, the first is a tag, which contains the valid value and the address mapping relationship. The second part is data storage. When the processor accesses the cache, the cache processor compares the relationship between the address and the tag. When the address comparison is successful, the representative can directly get data from the cache. Conversely, the cache processor will capture related data through the AHB Master and put the data into the cache and respond to the processor’s data.</p>
<p>When most of the data can be successfully compared in the tag, the waiting time of the processor can be greatly reduced, and the use efficiency can be increased.</p>
</section>
</section>
<section id="register-description">
<h2><span class="section-number">7.4. </span>Register description<a class="headerlink" href="#register-description" title="Permalink to this headline"></a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 61%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#l1c-config">l1c_config</a></p></td>
<td><p>L1C configuration</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hit-cnt-lsb">hit_cnt_lsb</a></p></td>
<td><p>Low 32-bit hit couter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hit-cnt-msb">hit_cnt_msb</a></p></td>
<td><p>High 32-bit hit counter</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#miss-cnt">miss_cnt</a></p></td>
<td><p>Miss counter</p></td>
</tr>
</tbody>
</table>
<section id="l1c-config">
<h3><span class="section-number">7.4.1. </span>l1c_config<a class="headerlink" href="#l1c-config" title="Permalink to this headline"></a></h3>
<p><strong>Address：</strong>  0x40009000</p>
<figure class="align-center">
<img alt="../_images/l1c_l1c_config.svg" src="../_images/l1c_l1c_config.svg" /></figure>
<table class="colwidths-given docutils align-center" style="width: 100%">
<colgroup>
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Reset</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>31:30</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>29</p></td>
<td><p>l1c_flush_done</p></td>
<td><p>r</p></td>
<td><p>0</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>28</p></td>
<td><p>l1c_flush_en</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>flush dirty line</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>wrap_dis</p></td>
<td><p>r/w</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>early_resp_dis</p></td>
<td><p>r/w</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>23:20</p></td>
<td><p>l1c_bmx_timeout_en</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>Bus timeout enable: detect slave no reaponse in 1024 cycles</p></td>
</tr>
<tr class="row-even"><td><p>19:18</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17:16</p></td>
<td><p>l1c_bmx_arb_mode</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>[1:0] 0:fix, 2:round-robin, 3:random</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>l1c_bmx_err_en</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>Bus error response enable</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>l1c_bypass</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>bypass cache ; reset cache</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>irom_2t_access</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td><p>Set 1 for ROM 2T access if CPU freq &gt;72MHz</p></td>
</tr>
<tr class="row-even"><td><p>11:8</p></td>
<td><p>l1c_way_dis</p></td>
<td><p>r/w</p></td>
<td><p>4’b1111</p></td>
<td><p>Disable part of cache ways &amp; used as ITCM</p></td>
</tr>
<tr class="row-odd"><td><p>7:2</p></td>
<td><p>RSVD</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>l1c_cnt_en</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>l1c_cacheable</p></td>
<td><p>r/w</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="hit-cnt-lsb">
<h3><span class="section-number">7.4.2. </span>hit_cnt_lsb<a class="headerlink" href="#hit-cnt-lsb" title="Permalink to this headline"></a></h3>
<p><strong>Address：</strong>  0x40009004</p>
<figure class="align-center">
<img alt="../_images/l1c_hit_cnt_lsb.svg" src="../_images/l1c_hit_cnt_lsb.svg" /></figure>
<table class="colwidths-given docutils align-center" style="width: 100%">
<colgroup>
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Reset</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>31:0</p></td>
<td><p>hit_cnt_lsb</p></td>
<td><p>r</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="hit-cnt-msb">
<h3><span class="section-number">7.4.3. </span>hit_cnt_msb<a class="headerlink" href="#hit-cnt-msb" title="Permalink to this headline"></a></h3>
<p><strong>Address：</strong>  0x40009008</p>
<figure class="align-center">
<img alt="../_images/l1c_hit_cnt_msb.svg" src="../_images/l1c_hit_cnt_msb.svg" /></figure>
<table class="colwidths-given docutils align-center" style="width: 100%">
<colgroup>
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Reset</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>31:0</p></td>
<td><p>hit_cnt_msb</p></td>
<td><p>r</p></td>
<td><p>0</p></td>
<td><p>total hit count = hit_cnt_msb*2^32 + hit_cnt_lsb</p></td>
</tr>
</tbody>
</table>
</section>
<section id="miss-cnt">
<h3><span class="section-number">7.4.4. </span>miss_cnt<a class="headerlink" href="#miss-cnt" title="Permalink to this headline"></a></h3>
<p><strong>Address：</strong>  0x4000900c</p>
<figure class="align-center">
<img alt="../_images/l1c_miss_cnt.svg" src="../_images/l1c_miss_cnt.svg" /></figure>
<table class="colwidths-given docutils align-center" style="width: 100%">
<colgroup>
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Bit</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Reset</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>31:0</p></td>
<td><p>miss_cnt</p></td>
<td><p>r</p></td>
<td><p>0</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="DMA.html" class="btn btn-neutral float-left" title="6. DMA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="IR.html" class="btn btn-neutral float-right" title="8. IR" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>