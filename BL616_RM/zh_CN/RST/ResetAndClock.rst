============
复位和时钟
============
简介
========
芯片内的时钟源：XTAL，PLL，RC。搭配分频等配置送至各模块。

复位管理
===========
.. table:: 软件复位功能表 

    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | BL616      | RST_PIN/ Watch Dog/ PDS/             | Software Reset    | System Reset (swrst_cfg2[2])/ | CPU Reset (swrst_cfg2[1])/ |
    |            +                                      +                   +                               +                            +
    |            | Software Power On (swrst_cfg2[0])    | (swrst_cfg1)      | PDS                           | PDS                        |
    +============+======================================+===================+===============================+============================+
    | cpu(M0)    | ✔                                    |                   |                               | ✔                          |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | bus        | ✔                                    |                   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | glb        | ✔                                    | swrst_s1[0]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | mix        | ✔                                    | swrst_s1[1]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | gpip       | ✔                                    | swrst_s1[2]       | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sec_eng    | ✔                                    | swrst_s1[4]       | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | tz         | ✔                                    |                   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | efuse      | ✔                                    |                   |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | dma        | ✔                                    | swrst_s1[12]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sdu/usb    | ✔                                    | swrst_s1[13]      |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | mm_misc    | ✔                                    | swrst_s1_ext[1]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | psram_ctrl | ✔                                    | swrst_s1_ext[2]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | usb        | ✔                                    | swrst_s1_ext[3]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | audio play | ✔                                    | swrst_s1_ext[5]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sdh        | ✔                                    | swrst_s1_ext[6]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | emac       | ✔                                    | swrst_s1_ext[7]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | pds        |                                      | swrst_s1[14]      |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | uart0      | ✔                                    | swrst_s1a[0]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | uart1      | ✔                                    | swrst_s1a[1]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | spi        | ✔                                    | swrst_s1a[2]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2c0       | ✔                                    | swrst_s1a[3]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | pwm        | ✔                                    | swrst_s1a[4]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | timer      | ✔                                    | swrst_s1a[5]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | irr        | ✔                                    | swrst_s1a[6]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | cks        | ✔                                    | swrst_s1a[7]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | dbi        | ✔                                    | swrst_s1a[8]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2c1       | ✔                                    | swrst_s1a[9]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    |ISO11898_fd | ✔                                    | swrst_s1a[10]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2s        | ✔                                    | swrst_s1a[11]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    |audio record| ✔                                    | swrst_s1a[12]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | wifi       | ✔                                    | swrst_s2[0]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | ble        | ✔                                    | swrst_s3[0][2]    |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+


时钟源
===========

时钟源包含：

- XTAL   ：外部晶振时钟，视系统需求频率可选 24、32、38.4、40MHz
- XTAL32K：外部晶振时钟，频率32kHz
- RC32K  ：RC振荡器时钟，频率32kHz，提供校准
- RC32M  ：RC振荡器时钟，频率32MHz，提供校准
- PLL    ：多个PLL模块，可以产生若干不同频率的时钟，以满足各个应用场景

时钟控制单元将来自振荡器的时钟分配给内核和外围设备。
可通过选择系统时钟源，动态分频器，时钟配置，睡眠使用32kHz时钟，以达到低功耗时钟管理。

外围设备时钟包括: Flash、UART、I2C、SPI、PWM、IR-remote、ADC、DAC。

 .. figure:: ../../picture/SystemClock.svg
    :align: center

    系统时钟架构 

 .. figure:: ../../picture/MoudleClock.svg
    :align: center
 
    模块时钟架构 
    
 .. figure:: ../../picture/PeripheralClock.svg
    :align: center
 
    外设时钟架构


