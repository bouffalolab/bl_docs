============
Reset and Clock
============
Overview
========
The clock sources in the chip include XTAL, PLL, and RC. They are sent to each module along with frequency division configuration.

Reset Management
===========
.. table:: Software reset function table 
    :widths: 10, 27,15,25,23
    :width: 100%
    :align: center

    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | BL616      | RST_PIN/ Watch Dog/ PDS/             | Software Reset    | System Reset (swrst_cfg2[2])/ | CPU Reset (swrst_cfg2[1])/ |
    |            +                                      +                   +                               +                            +
    |            | Software Power On (swrst_cfg2[0])    | (swrst_cfg1)      | PDS                           | PDS                        |
    +============+======================================+===================+===============================+============================+
    | cpu(M0)    | ✔                                    |                   |                               | ✔                          |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | bus        | ✔                                    |                   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | glb        | ✔                                    | swrst_s1[0]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | mix        | ✔                                    | swrst_s1[1]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | gpip       | ✔                                    | swrst_s1[2]       | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sec_eng    | ✔                                    | swrst_s1[4]       | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | tz         | ✔                                    |                   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | efuse      | ✔                                    |                   |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | dma        | ✔                                    | swrst_s1[12]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sdu/usb    | ✔                                    | swrst_s1[13]      |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | mm_misc    | ✔                                    | swrst_s1_ext[1]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | psram_ctrl | ✔                                    | swrst_s1_ext[2]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | usb        | ✔                                    | swrst_s1_ext[3]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | audio play | ✔                                    | swrst_s1_ext[5]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | sdh        | ✔                                    | swrst_s1_ext[6]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | emac       | ✔                                    | swrst_s1_ext[7]   | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | pds        |                                      | swrst_s1[14]      |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | uart0      | ✔                                    | swrst_s1a[0]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | uart1      | ✔                                    | swrst_s1a[1]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | spi        | ✔                                    | swrst_s1a[2]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2c0       | ✔                                    | swrst_s1a[3]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | pwm        | ✔                                    | swrst_s1a[4]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | timer      | ✔                                    | swrst_s1a[5]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | irr        | ✔                                    | swrst_s1a[6]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | cks        | ✔                                    | swrst_s1a[7]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | dbi        | ✔                                    | swrst_s1a[8]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2c1       | ✔                                    | swrst_s1a[9]      | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    |ISO11898_fd | ✔                                    | swrst_s1a[10]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | i2s        | ✔                                    | swrst_s1a[11]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    |audio record| ✔                                    | swrst_s1a[12]     | ✔                             |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | wifi       | ✔                                    | swrst_s2[0]       |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+
    | ble        | ✔                                    | swrst_s3[0][2]    |                               |                            |
    +------------+--------------------------------------+-------------------+-------------------------------+----------------------------+


Clock Source
===========

Types:

- XTAL: external crystal oscillator clock, with optional frequencies of 24, 32, 38.4, and 40 MHz depending on system requirements
- XTAL32K: external crystal oscillator clock, with frequency of 32 kHz
- RC32K: RC oscillator clock with frequency of 32 kHz and calibration
- RC32M: RC oscillator clock with frequency of 32 MHz and calibration
- PLL: multiple PLL modules, which can generate several clocks with different frequencies to meet various application scenarios

The clock control unit distributes the clocks from the oscillator to the core and peripheral devices. You can choose the system clock source, dynamic frequency divider, and clock configuration, and use the 32 kHz clock in sleep to achieve low-power clock management.

Peripheral clocks include Flash, UART, I2C, SPI, PWM, IR-remote, ADC, and DAC.

.. figure:: ../../picture/SystemClock.svg
   :align: center

   System Clock Architecture
   
.. figure:: ../../picture/MoudleClock.svg
   :align: center

   Module Clock Architecture
   
.. figure:: ../../picture/PeripheralClock.svg
   :align: center

   Peripheral Clock Architecture


